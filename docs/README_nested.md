# Root‑MAS: Multi‑Agent System Platform

Этот репозиторий содержит базовую реализацию для развёртывания многоагентной системы (MAS), построенной на базе библиотеки **AutoGen**. Архитектура и проектные решения основаны на обсуждении с пользователем и включают подробный список корневых агентов, слои интеграции, память, каскад выбора LLM, а также интеграцию с n8n и Telegram.

> ⚠️ **Важно:** данный проект является заготовкой. Он не содержит полной реализации и требует доработки. Вам необходимо установить зависимости (AutoGen, OpenRouter SDK, Redis, PostgreSQL, Chroma и т. д.), заполнить `.env` реальными ключами доступа и настроить Docker‑окружение.

## Структура проекта

```
root_mas/
├── config/              # YAML‑конфигурации агентов и LLM‑каскада
├── deploy/              # Файлы docker‑compose для internal/client инстансов
├── prompts/             # Шаблоны системных промптов
├── tools/               # Скрипты интеграции (Telegram, n8n, GPT‑Pilot)
├── run.py               # Точка входа для запуска Root GroupChat
└── README.md            # Описание проекта (этот файл)
```

### config/
- **agents.yaml** — описание корневых агентов, их ролей, моделей и памяти.
- **llm_tiers.yaml** — каскад выбора моделей по уровням (cheap, standard, premium).
- **instances.yaml** — регистрация развёрнутых internal/client инстансов.

### deploy/
- **internal/compose.yml** — docker‑compose для развёртывания внутренней MAS (shared ключи).
- **client/compose.yml** — docker‑compose для развёртывания клиентской MAS (уникальные ключи).

### prompts/
- **global/system.md** — глобальный системный промпт для всех агентов.
- **agents/*/system.md** — системные промпты для каждого корневого агента (Meta, Coordination и др.).

### tools/
Содержит интеграционные скрипты:
- **telegram_voice.py** — телеграм‑бот с поддержкой STT/TTS (заготовка).
- **n8n_client.py** — клиент для создания и активации workflow в n8n.
- **gpt_pilot.py** — обёртка для GPT‑Pilot API.
- **prompt_io.py** — вспомогательные функции для чтения/записи промптов.
- **llm_selector.py** — выбор модели LLM в соответствии с каскадной политикой.
- **callbacks.py** — реализация callback‑функций для маршрутизации событий.
- **callback_matrix.py** — сопоставление событий и callback‑функций.
- **researcher.py** и **fact_checker.py** — заготовки агентов Researcher и Fact‑Checker.
- **cron.py** — простейший планировщик задач.

### memory/
Содержит модули для взаимодействия с различными хранилищами данных:
- **redis_store.py** — клиент Redis для временного кэширования.
- **postgres_store.py** — клиент PostgreSQL для хранения постоянных данных.
- **chroma_store.py** — заготовка клиента ChromaDB для работы с векторной памятью.

## Роли корневых агентов

- **Meta** — управляет высокоуровневыми целями и распределяет задачи между остальными агентами.
- **Coordination** — ведёт очередь заданий и планировщик.
- **Prompt‑Builder** — поддерживает системные промпты и контроль версий.
- **Model‑Selector** — выбирает подходящую LLM исходя из цены и качества.
- **Agent‑Builder** — создаёт новых агентов по спецификации.
- **Instance‑Factory** — разворачивает MAS‑инстансы и настраивает Docker.
- **Researcher** — собирает информацию из внешних источников и API.
- **Fact‑Checker** — проверяет достоверность данных.
- **MultiTool** — шлюз для вызова сторонних API.
- **WF‑Builder** — генерирует workflow для n8n.
- **WebApp‑Builder** — создаёт веб‑приложения через GPT‑Pilot.
- **Communicator** — взаимодействует с пользователем в Telegram и хранит историю переписки.

## Быстрый старт

1. Клонируйте репозиторий и перейдите в директорию `root_mas`.
2. Скопируйте файл `.env.example` в `.env` и заполните ключи (`OPENROUTER_API_KEY`, `YANDEX_API_KEY`, `YANDEX_FOLDER_ID`, `N8N_API_TOKEN`, `TELEGRAM_BOT_TOKEN`).
3. Установите зависимости командой `pip install -r requirements.txt`.
4. Запустите сервисы Docker:

   ```bash
   cd deploy/internal
   cp .env.example .env  # при необходимости
   docker compose up -d
   ```

   Будут подняты PostgreSQL, Redis, ChromaDB и n8n.
5. Запустите базовый цикл `python run.py --goal "echo"` и убедитесь, что Root GroupChat отвечает.
6. Используйте n8n и Telegram‑бот, как описано в плане работ, чтобы постепенно добавлять функциональность.

## План работ

Полный план работ разбит на 14 двухнедельных спринтов (см. файл, предоставленный пользователем). Рекомендуется начинать со спринта 0 — подготовка основы, настройка LLM‑каскада и проверка эхо‑агента.

Приятной разработки!